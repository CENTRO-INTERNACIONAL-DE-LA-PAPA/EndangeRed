---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# EndangeRed

<!-- badges: start -->
<!-- badges: end -->

The goal of EndangeRed is to provide a tool to calculate the Red Listing of varieties based on the Overall Cultivar Frequency (OCF) and Relative Cultivar Frequency (RCF) values.

## Installation

You can install the development version of EndangeRed like this:

``` r
remotes::install_github("https://github.com/CENTRO-INTERNACIONAL-DE-LA-PAPA/EndangeRed")
```

## Example

This is a basic example which shows you how to get the Red Listing of varieties based on the Overall Cultivar Frequency (OCF) and Relative Cultivar Frequency (RCF) values.

Here we have two years of data, 2013 and 2017 on the same location.

```{r example}

library(EndangeRed)
library(dplyr)
library(tidyr)
data("Huancavelica_2013")

Huancavelica_2013 %>% 
    head(5)

```

First let's select a year. For this example we will use Huancavelica data from 2013.

```{r}

ocf_data <- OCF(
    dfr = Huancavelica_2013,
    vname = "final_variety_name",
    hh = "household",
    community = "comunidad",
    location = "region"
)

print(head(ocf_data))

rcf_data <- RCF(
    dfr = Huancavelica_2013,
    vname = "final_variety_name",
    hh = "household",
    nsvarie = "cantidad",
    community = "comunidad",
    location = "region"
)

print(head(rcf_data))

```

If we need to get the endangered varieties we can do it by using calling the function `get_red_listing`.

```{r}

endangered_varieties <- get_red_listing(Huancavelica_2013)

endangered_varieties %>% 
    pull(risk_category) %>% table()

```

Let's see which varieties are the ones **At Risk**

```{r}

endangered_varieties %>% 
    dplyr::filter(risk_category == "At Risk") %>% 
    pull(final_variety_name)

```

